; cPanel-generated php ini directives, do not edit
; Manual editing of this file may result in unexpected behavior.
; To make changes to this file, use the cPanel MultiPHP INI Editor (Home >> Software >> MultiPHP INI Editor)
; For more information, read our documentation (https://go.cpanel.net/EA4ModifyINI)

display_errors = Off
max_execution_time = 30
max_input_time = 60
max_input_vars = 1000
memory_limit = 128M
post_max_size = 128M
session.gc_maxlifetime = 1440
session.save_path = "/var/cpanel/php/sessions/ea-php81"
upload_max_filesize = 10M
zlib.output_compression = Off

function compressUploadMaxSize($newSize) {
    $uploadMaxSize = ini_get('upload_max_filesize');
    
    // Extract the numeric value and unit from the current upload_max_filesize
    preg_match('/^(\d+)(\D*)$/', $uploadMaxSize, $matches);
    $currentSize = (int)$matches[1];
    $currentUnit = $matches[2];
    
    // Convert the new size to bytes
    $newSizeInBytes = $newSize;
    $units = ['B', 'K', 'M', 'G', 'T'];
    $unitIndex = array_search(strtoupper($currentUnit), $units);
    
    if ($unitIndex !== false) {
        $newSizeInBytes *= 1024 ** $unitIndex;
    }
    
    // Compare the new size with the current size
    if ($newSizeInBytes <= $currentSize) {
        return "upload_max_filesize is already within the limit.";
    }
    
    // Calculate the new value and unit
    $newSizeValue = $newSizeInBytes;
    $newSizeUnit = 'B';
    
    foreach ($units as $unit) {
        if ($newSizeValue < 1024) {
            $newSizeUnit = $unit;
            break;
        }
        
        $newSizeValue /= 1024;
    }
    
    $newUploadMaxSize = round($newSizeValue, 2) . $newSizeUnit;
    
    // Update the upload_max_filesize directive
    ini_set('upload_max_filesize', $newUploadMaxSize);
    
    return "upload_max_filesize has been updated to $newUploadMaxSize.";
}

// Usage example
$newSize = 15 * 1024 * 1024; // 15MB in bytes
$result = compressUploadMaxSize($newSize);
echo $result;
